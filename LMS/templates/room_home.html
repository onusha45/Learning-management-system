{% extends 'header.html' %}
{% load static %}

{% block contents %}
    <p>Hello {{request.user}}</p>
    <div class="home-container">
        <div>
            <h3>Search container</h3>
            <form action="{%url 'room_home'%}">
                <input type="text" name="q" placeholder="Search Rooms...."/>
              </form>
           <hr>
           
            <div>
                <a href="{% url 'room_home' %}">ALL</a>
            </div>
            {% for topic in topics %}
            <div>
                <a href="{% url 'room_home' %}?q={{topic.name}}">{{topic}}</a>
            </div>
            {% endfor %}
        </div>
       <div>
        <h5>{{room_count}} Rooms Available</h5>
        
            {% for room in rooms %}
            <div>
             
            <tr>
                <span>@{{ room.host.username }}</span>
                    <a href="{% url 'room_list' room.id %}">
                        <h5>{{ room.room_name }}</h5>
                    </a>
                 
                <small>{{ room.topic.name }}</small>
                {% if request.user == room.host %}
                
                    <a  href="" class="delete_room" data-room-id ="{{room.id}}">Delete</a>
                


                   <a  href="{% url 'room_edit' room.id %}" class="">Edit</a>
                 
            
                {% endif %}
                
            <hr>
        </div>
            {% endfor %}
            </table>
        </div>
        <div class="">
            <h3>Recent Activity </h3>
            <hr>
            {% for message in room_messages %}
            <div>
                
                <small>@{{message.user}}  {{message.created_date|timesince}}</small>
                <small>replied to "{{message.room}}"</small>
                <p>{{message}}</p>
                {% if request.user == message.user%}
                <a href="{% url 'delete-message' message.id %}">Delete</a>
                 {% endif %}
              <hr>
            </div>
            {% endfor %}

        </div>
    </div>
        <div >
            <a href="{% url 'room_register' %}" class="btn btn-success">Room Registration</a>
            <a href="{% url 'user_logout' %}" onclick="return confirm('Are you sure ??')" class="btn btn-secondary">Logout</a>
            
        </div>
        {% for room in rooms %}
       <form method="POST" action="{% url 'room_delete' room.id %}" style="display: none;" id="form_delete_{{room.id}}">
       
        {% csrf_token %}
        <button type="submit"></button>
        </form>
        {% endfor %}
    
       {% endblock %}

       

   